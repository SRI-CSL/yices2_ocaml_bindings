(rule
 (targets gmp.mlh)
 (deps (:gmp ../config/gmp.mlh))
 (mode (promote (until-clean)))
 (action (copy %{gmp} %{targets})))

(library
 (name yices2)
 (public_name yices2)
 (libraries ctypes ctypes.foreign sexplib containers libpoly_bindings config)
 (flags (:standard -cclib -lyices -ccopt "$LDFLAGS"))
 (preprocess (pps ppx_deriving.std ppx_optcomp))
 (synopsis "Yices2 bindings")

(ctypes
    (external_library_name yices)
    ; (build_flags_resolver pkg_config)
    (build_flags_resolver (vendored (c_flags ) (c_library_flags )))
    (headers (include "yices.h"))
    (type_description
      (instance Type)
      (functor Type_description))
    (function_description
      (instance Function)
      (functor Function_description)
      ; <optional-function-description-fields>
      )
    (generated_entry_point Header)
    ; <optional-ctypes-fields>
    )
)

(env (dev
        (flags (:standard -warn-error -A))))
